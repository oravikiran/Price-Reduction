<html><head><style>body {
   color: black;
}
code{
font-weight:10px;
}</style></head><body><h1 id="products-restful-webservice">Products Restful Webservice</h1>
<p>This is a Java / Maven / Spring Boot (version 2.5.0) application that creates a restful webservice to request dresses that have a price reduction from the below API,</br>
<a href="https://api.johnlewis.com/search/api/rest/v2/catalog/products/search/keyword?q=dresses&amp;key=AIzaSyDD_6O5gUgC4tRW5f9kxC0_76XRC8W7_mI">https://api.johnlewis.com/search/api/rest/v2/catalog/products/search/keyword?q=dresses</a></p>
<h2 id="about-the-service">About the Service</h2>
<p>The array of products processed from the <a href="https://api.johnlewis.com/search/api/rest/v2/catalog/products/search/keyword?q=dresses&amp;key=AIzaSyDD_6O5gUgC4tRW5f9kxC0_76XRC8W7_mI">provided api url</a> should only contain products with a price reduction and should be sorted to show the highest price reduction first. 
Price reduction is calculated using price.was - price.now.</p>
<p><strong>NOTE:</strong>
<em>If there is invalid data in the <a href="https://api.johnlewis.com/search/api/rest/v2/catalog/products/search/keyword?q=dresses&amp;key=AIzaSyDD_6O5gUgC4tRW5f9kxC0_76XRC8W7_mI">used</a> api response then assuming a value of zero rather than throwing exceptions or creating complex error logging.</em></p>
<p>Each products in the returned array should contain:</p>
<p><code>productId &lt;String&gt;</code></p>
<p><code>title &lt;String&gt;</code></p>
<p><code>An array of colorSwatches</code>. Each element should contain:</p>
<ul>
<li><code>color&lt;String&gt;</code></li>
<li><code>rgbColor&lt;String&gt;</code> which is an RGB representation of the basicColor in a six digit
hexadecimal format, e.g. “F0A1C2”.</li>
<li><code>skuid&lt;String&gt;</code></li>
<li><code>nowPrice&lt;String&gt;</code> which is the price.now represented as a string, including the currency, e.g.
“£1.75”. For values that are integer, if they are less £10 return a decimal price, otherwise show an
integer price, e.g. “£2.00” or “£10”.</li>
</ul>
<p><code>priceLabel&lt;String&gt;</code>. An optional query parm called labelType can be set to any of:</p>
<ol>
<li><strong>ShowWasNow</strong> - in which case return a string saying “Was £x.xx, now £y.yyy”.</li>
<li><strong>ShowWasThenNow</strong> - in which case return a string saying “Was £x.xx, then £y.yy, now
£z.zzz”. If the original price.then2 is not empty use that for the “then” price otherwise use
the then1 price. If the then1 price is also empty then don’t show the “then” price.</li>
<li><strong>ShowPercDscount</strong> - in which case return “x% off - now £y.yy”.
If the query parm is not set default to use ShowWasNow format.
In all cases use the price formatting as described for nowPrice</li>
</ol>
<h3 id="retrieve-list-of-products">Retrieve list of products</h3>
<pre><code>GET <span class="hljs-string">http:</span><span class="hljs-comment">//localhost:1221/price-reduction/fetchProducts?labelType=ShowWasNow</span>

http-<span class="hljs-string">status:</span> <span class="hljs-number">200</span>
<span class="hljs-string">connection:</span> keep-alive 
content-<span class="hljs-string">type:</span> application/json 
<span class="hljs-string">date:</span> Fri,<span class="hljs-number">11</span> Jun <span class="hljs-number">2021</span> <span class="hljs-number">07</span>:<span class="hljs-number">53</span>:<span class="hljs-number">46</span> GMT 
keep-<span class="hljs-string">alive:</span> timeout=<span class="hljs-number">60</span> 
transfer-<span class="hljs-string">encoding:</span> chunked 

Response <span class="hljs-string">Body:</span> 
[
  {
    <span class="hljs-string">"productId"</span>: <span class="hljs-string">"4873363"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Ghost Astrid Floral Dress, Navy Clusters"</span>,
    <span class="hljs-string">"colorSwatches"</span>: [
      {
        <span class="hljs-string">"color"</span>: <span class="hljs-string">"Blue"</span>,
        <span class="hljs-string">"rgbColor"</span>: <span class="hljs-string">"0000FF"</span>,
        <span class="hljs-string">"skuId"</span>: <span class="hljs-string">"238346446"</span>
      }
    ],
    <span class="hljs-string">"nowPrice"</span>: <span class="hljs-string">"£74"</span>,
    <span class="hljs-string">"priceLabel"</span>: <span class="hljs-string">"Was £149, now £74"</span>
  },
  {
    <span class="hljs-string">"productId"</span>: <span class="hljs-string">"4823284"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Hobbs Astraea Floral Dress, Navy/Ivory"</span>,
    <span class="hljs-string">"colorSwatches"</span>: [
      {
        <span class="hljs-string">"color"</span>: <span class="hljs-string">"Blue"</span>,
        <span class="hljs-string">"rgbColor"</span>: <span class="hljs-string">"0000FF"</span>,
        <span class="hljs-string">"skuId"</span>: <span class="hljs-string">"238448191"</span>
      }
    ],
    <span class="hljs-string">"nowPrice"</span>: <span class="hljs-string">"£99"</span>,
    <span class="hljs-string">"priceLabel"</span>: <span class="hljs-string">"Was £169, now £99"</span>
  }
]
</code></pre><h2 id="how-to-run">How to Run</h2>
<p>This application is packaged as a jar which has Tomcat 8 embedded. No Tomcat or JBoss installation is necessary. You run it using the <code>java -jar</code> command.</p>
<ul>
<li>Clone this repository </li>
<li>Make sure you are using JDK 1.8 and Maven 3.x</li>
<li>You can build the project and run the tests by running <code>mvn clean package</code></li>
<li>Once successfully built, you can run the service by one of these two methods:<pre><code>      java -jar target/<span class="hljs-built_in">price</span>-reduction-<span class="hljs-number">0.0</span>.<span class="hljs-number">1</span>-SNAPSHOT.war
<span class="hljs-built_in">or</span>
      mvn spring-bo<span class="hljs-symbol">ot:ru</span><span class="hljs-built_in">n</span>
</code></pre></li>
</ul>
<p>Once the application runs you should see something like this</p>
<pre><code><span class="hljs-number">2021</span>-<span class="hljs-number">06</span>-<span class="hljs-number">11</span> <span class="hljs-number">13</span>:<span class="hljs-number">18</span>:<span class="hljs-number">04.658</span>  INFO <span class="hljs-number">7108</span> --- [  restartedMain] o<span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.b</span><span class="hljs-selector-class">.w</span><span class="hljs-selector-class">.embedded</span><span class="hljs-selector-class">.tomcat</span><span class="hljs-selector-class">.TomcatWebServer</span>  : Tomcat started on port(s): <span class="hljs-number">1221</span> (http) with context path <span class="hljs-string">'/price-reduction'</span>
<span class="hljs-number">2021</span>-<span class="hljs-number">06</span>-<span class="hljs-number">11</span> <span class="hljs-number">13</span>:<span class="hljs-number">18</span>:<span class="hljs-number">04.667</span>  INFO <span class="hljs-number">7108</span> --- [  restartedMain] com<span class="hljs-selector-class">.java</span><span class="hljs-selector-class">.app</span><span class="hljs-selector-class">.PriceReductionApplication</span>   : Started PriceReductionApplication <span class="hljs-keyword">in</span> <span class="hljs-number">2.266</span> seconds (JVM running <span class="hljs-keyword">for</span> <span class="hljs-number">3.312</span>)
</code></pre><h2 id="flow-of-the-codebase">Flow of the CodeBase</h2>
<ol>
<li>c.j.a.c.PriceReductionController         : Request Recielved from client: <a href="http://localhost:1221/price-reduction/fetchProducts">http://localhost:1221/price-reduction/fetchProducts</a></li>
<li>c.j.a.c.PriceReductionController         : Inside PriceReductionController Class....</li>
<li>c.j.a.c.PriceReductionController         : Calling getProducts() method....</li>
<li>c.j.a.c.PriceReductionController         : Fetching Products from Service....</li>
<li>c.j.a.service.PriceReductionServiceImpl  : Inside PriceReductionServiceImpl Class....</li>
<li>c.j.a.service.PriceReductionServiceImpl  : Calling fetchAllProducts(ShowWasNow) method....</li>
<li>c.j.a.service.PriceReductionServiceImpl  : Fetching Products from Repository....</li>
<li>c.j.a.r.PriceReductionRepositoryImpl     : Inside PriceReductionRepositoryImpl Class....</li>
<li>c.j.a.r.PriceReductionRepositoryImpl     : Calling fetchAllProducts() method....</li>
<li>c.j.a.r.PriceReductionRepositoryImpl     : Fetching productUrl and productUrlKey from 11. api-url.properties file....</li>
<li>c.j.a.r.PriceReductionRepositoryImpl     : Hitting the Product API url: <a href="https://api.johnlewis.com/search/api/rest/v2/catalog/products/search/keyword?q=dresses&amp;key=AIzaSyDD_6O5gUgC4tRW5f9kxC0_76XRC8W7_mI">https://api.johnlewis.com/search/api/rest/v2/catalog/products/search/keyword?q=dresses&amp;key=AIzaSyDD_6O5gUgC4tRW5f9kxC0_76XRC8W7_mI</a></li>
<li>c.j.a.r.PriceReductionRepositoryImpl     : Got the response code: 200 OK</li>
<li>c.j.a.r.PriceReductionRepositoryImpl     : Returning the Product response to the Service....</li>
<li>c.j.a.service.PriceReductionServiceImpl  : Fetched Done from Repository....</li>
<li>c.j.a.service.PriceReductionServiceImpl  : Processing the fetched Products....</li>
<li>c.j.a.service.PriceReductionServiceImpl  : Processing Done....</li>
<li>c.j.a.service.PriceReductionServiceImpl  : Sorting the fetched Products based on reduced price....</li>
<li>c.j.a.service.PriceReductionServiceImpl  : Sorting Done....</li>
<li>c.j.a.service.PriceReductionServiceImpl  : Sending Processed Products (DTO) to the controller....</li>
<li>c.j.a.c.PriceReductionController         : Fetched Done from Service....</li>
<li>c.j.a.c.PriceReductionController         : Returing the response to the client....</li>
</ol>
</body></html>